# Nalog-App

### Описание
Программа для ускорения процессов отправки информации о доходах самозанятых с Wildberries представляет собой небольшое приложение с графическим интерфейсом, построенным при помощи **customtkinter**.


Программа получает Excel-документ `.xlsx` расширения, обрабатывает его и позволяет отправить необходимые поля сразу в https://lknpd.nalog.ru.

### Технические особенности

Документ с расширением `.xlsx` должен содержать [следующие поля](assets/example.csv). Такую таблицу можно получить, запросив детализацию еженедельного отчёта.

Так как в программе алгоритм получения необходимых данных построен на индексах, любые перестановки столбцов в исходной таблице невозможны.

Программа отбирает подходящие поля по следующим критериям:

1) Все отбираемые ячейки (см. ниже) должны быть заполнены

2) Ячейка в столбце «Тип документа» содержит текст «Продажа»

Из поля извлекаются ячейки, столбцами которых являются «Предмет», «Тип документа», «Дата продажи» и «Вайлдберриз реализовал Товар (Пр)»

Конкретно в nalog.ru отправляются только наименования, даты и цены. Другая информация обрабатывается, но никуда не отправляется и не хранится.

> [!IMPORTANT]
> 
> Данные отправляются именно по столбцу «Вайлдберриз реализовал Товар (Пр)», не розничной цене и т.д.


### Установка

1. Из релиза
    - Переходим к последним релизам
    - В файлах релиза находим свою операционную систему и архитектуру
    - Скачиваем архив
    - Извлекаем его

> [!TIP]  
>
> Если по какой-то причине в релизах отсутствует сборка под необходимую вам операционную систему или архитектуру, пожалуйста, соберите программу самостоятельно по руководству, описанному ниже. К сожалению, для Python, насколько мне известно, не существует кросс-компиляторов, поэтому сборки программы под какую-то определённую операционную систему может и не быть.
>
> Однако вы можете написать в issue с требуемой вам сборкой и мы попробуем что-нибудь придумать.

2. Сборка из исходного кода
    - Клонируем репозиторий
    ```bash
    git clone https://github.com/byBenPuls/nalog-app
    ```
    - Проверяем, установлен ли [python](https://www.python.org/downloads/) версии не меньше, чем 3.12 
    - Открываем проект
    - Создаём виртуальное окружение в корневой папке проекта
    ```bash
    py -m venv .venv
    ```
    - Активируем виртуальное окружение
        * Для Windows:
        ```bash
        .\venv\Scripts\activate
        ```
        * Для Linux/macOS
        ```bash
        source .venv/bin/activate
        ```
    - Устанавливаем **poetry**
        ```
        pip install poetry
        ```
    - Собираем через Makefile:
        ```bash
        make build-app
        ```
    - Если через Makefile собрать не получается
        ```bash
        poetry install --with dev
        ```
        Для Linux:
        ```bash
        pyinstaller --onefile --name "nalog" --noconsole -i "./assets/wb.gif" run.py
        ```
        Для Windows/macOS:
        ```bash
        pyinstaller --onefile --name "nalog" --noconsole -i "./assets/wb.ico" run.py
        ```
    - В появившейся папке dist находим собранную программу